<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador Oral IB: Bloque Integrado</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        @media print { .no-print { display: none; } }
        @keyframes pulse-red { 0%, 100% { background-color: #ef4444; } 50% { background-color: #b91c1c; } }
        .recording-active { animation: pulse-red 1.5s infinite; }
    </style>
</head>
<body class="bg-slate-50 min-h-screen pb-12">
<div style="position:fixed;top:20px;left:20px;z-index:9999" class="no-print"><a href="/resources.html" style="display:inline-flex;align-items:center;gap:8px;padding:10px 16px;background:#6366f1;color:white;border-radius:8px;text-decoration:none;font-weight:600;box-shadow:0 2px 8px rgba(0,0,0,0.15);transition:all 0.2s" onmouseover="this.style.background='#4f46e5'" onmouseout="this.style.background='#6366f1'"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>Back to Resources</a></div>

    

    <div class="max-w-4xl mx-auto px-4 py-8">
        <!-- Header -->
        <header class="text-center mb-8 no-print">
            <h1 class="text-3xl font-bold text-slate-800">Práctica de Examen Oral: Ab Initio</h1>
            <p class="text-slate-600 mt-2 font-medium">Bloque Integrado: Ocio, Tecnología y Viajes</p>
            <div class="mt-4 flex justify-center gap-4">
                <button onclick="window.print()" class="bg-white border border-slate-300 px-4 py-2 rounded-lg text-sm font-semibold hover:bg-slate-50 transition shadow-sm">
                    🖨️ Imprimir Guía
                </button>
            </div>
        </header>

        <!-- Ficha de Preparación -->
        <section id="prep-section" class="bg-white rounded-xl shadow-sm border border-slate-200 p-8 mb-8">
            <h2 class="text-xl font-semibold text-slate-800 mb-6 flex items-center gap-2">
                <span class="bg-blue-100 text-blue-600 p-1.5 rounded-md">📝</span>
                1. Ficha de Notas Personales
            </h2>
            <p class="text-sm text-slate-500 mb-6 italic">Organiza tus ideas y vocabulario para los tres temas antes de empezar el simulacro.</p>
            <div id="prep-list" class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6">
                <!-- Preguntas cargadas dinámicamente -->
            </div>
        </section>

        <!-- Modelos de Referencia -->
        <section id="ref-section" class="bg-white rounded-xl shadow-sm border border-slate-200 p-8 mb-8">
            <h2 class="text-xl font-semibold text-slate-800 mb-6 flex items-center gap-2">
                <span class="bg-amber-100 text-amber-600 p-1.5 rounded-md">💡</span>
                2. Modelos de Respuesta (Nivel de Excelencia)
            </h2>
            <div id="reference-guide" class="space-y-4 max-h-[600px] overflow-y-auto pr-2 custom-scrollbar">
                <!-- Se cargan dinámicamente -->
            </div>
        </section>

        <!-- Simulador -->
        <section id="sim-section" class="no-print bg-slate-900 rounded-2xl p-8 text-white shadow-2xl relative overflow-hidden min-h-[450px] flex flex-col justify-between">
            <div class="relative z-10 w-full">
                <!-- Progress & Timer -->
                <div class="flex justify-between items-center mb-10">
                    <span id="progress-text" class="bg-slate-800 text-slate-400 px-3 py-1 rounded-full text-xs font-mono uppercase">Pregunta 1 de 34</span>
                    <div id="timer-display" class="text-4xl font-bold font-mono text-indigo-400">30s</div>
                </div>

                <!-- Main Content -->
                <div id="sim-content" class="text-center">
                    <div class="min-h-[140px] flex flex-col items-center justify-center">
                        <h3 id="current-question" class="text-2xl font-semibold leading-relaxed mb-6 px-4">¿Preparado para el gran simulacro de los tres bloques?</h3>
                        
                        <div id="initial-controls">
                            <button onclick="initApp()" class="bg-indigo-600 hover:bg-indigo-700 px-10 py-4 rounded-xl font-bold text-lg transition shadow-xl shadow-indigo-500/20">
                                Empezar Práctica Real
                            </button>
                        </div>

                        <div id="active-controls" class="hidden flex flex-col items-center gap-6 w-full">
                            <button id="record-btn" onclick="toggleRecording()" class="bg-red-600 hover:bg-red-700 px-10 py-4 rounded-xl font-bold transition flex items-center gap-3 shadow-lg shadow-red-500/20">
                                <span id="rec-dot" class="w-3 h-3 bg-white rounded-full"></span>
                                <span id="rec-text">Grabar Respuesta</span>
                            </button>
                        </div>
                    </div>

                    <!-- Individual Feedback Area -->
                    <div id="review-area" class="hidden mt-8 space-y-4 text-left w-full max-w-2xl mx-auto">
                        <div class="bg-slate-800 rounded-xl p-6 border border-slate-700">
                            <h4 class="text-xs font-bold text-slate-400 uppercase tracking-widest mb-4">Escucha tu respuesta</h4>
                            <audio id="audio-playback" controls class="w-full mb-6 filter invert opacity-80"></audio>

                            <!-- Mini Modelo en el simulador -->
                            <div class="bg-indigo-900/30 rounded-xl p-6 border border-indigo-500/30">
                                <div id="model-answer-content" class="text-sm text-indigo-100 leading-relaxed italic">
                                    <!-- Se carga dinámicamente -->
                                </div>
                            </div>
                        </div>
                        <button onclick="nextQuestion()" class="w-full bg-white text-slate-900 py-3 rounded-lg font-bold hover:bg-slate-100 transition shadow-lg">Siguiente Pregunta ?</button>
                    </div>
                </div>
            </div>

            <!-- Reporte Final UI -->
            <div id="final-report" class="hidden relative z-10 w-full max-w-2xl mx-auto text-left py-4">
                <div class="bg-white rounded-2xl p-8 text-slate-900 shadow-2xl border-t-8 border-indigo-600">
                    <h2 class="text-2xl font-bold mb-4 flex items-center gap-2 text-indigo-700">
                        ¡Simulacro Completado! 🎉
                    </h2>
                    <p class="text-slate-600 text-sm mb-6 pb-4 border-b">Has practicado todas las preguntas sobre <strong>Ocio, Tecnología y Viajes</strong>.</p>
                    
                    <div class="bg-slate-50 p-6 rounded-xl mb-6 border border-slate-100 italic text-slate-700 text-sm">
                        "¡Increíble esfuerzo! Has repasado una gran parte del temario. Recuerda que la constancia es la clave. Sigue usando conectores complejos y tiempos verbales variados para brillar en tu examen oral."
                    </div>

                    <button onclick="location.reload()" class="w-full bg-indigo-600 text-white py-4 rounded-xl font-bold hover:bg-indigo-700 transition">Reiniciar Simulacro</button>
                </div>
            </div>

            <!-- BG Pattern -->
            <div class="absolute -bottom-24 -right-24 w-80 h-80 bg-indigo-500/10 rounded-full blur-3xl"></div>
        </section>
    </div>

    <script>
        const questions = [
            // PAGINA 6 - OCIO Y COMPRAS
            { q: "¿Qué te gusta hacer en tu tiempo libre?", model: "En mi tiempo libre suelo relajarme leyendo o saliendo con mis amigos. Además, me apasiona la música y a menudo toco la guitarra para desconectar del estrés del colegio." },
            { q: "¿Te gustan los deportes? ¿Cuáles?", model: "Sí, me considero una persona activa. Practico natación dos veces por semana y los sábados juego al tenis con mi padre porque es muy divertido y competitivo." },
            { q: "¿Qué hiciste el fin de semana pasado?", model: "El fin de semana pasado fui al cine con mis primos y después cenamos en un restaurante italiano. Lo pasamos genial charlando sobre nuestras próximas vacaciones." },
            { q: "¿Qué vas a hacer el sábado que viene?", model: "El próximo sábado tengo planeado visitar un mercado artesanal en el centro. Por la noche, probablemente iré a una fiesta de cumpleaños de un compañero de clase." },
            { q: "¿Te gusta hacer compras? ¿Dónde?", model: "Me gusta ir de compras de vez en cuando, sobre todo a las tiendas de ropa vintage. Prefiero el centro de la ciudad porque hay mucha más variedad que en los centros comerciales." },
            { q: "¿Cómo son las tiendas en tu ciudad?", model: "En mi ciudad hay una mezcla de boutiques modernas y comercios tradicionales. Las tiendas del barrio son muy acogedoras, mientras que las del centro son más grandes y ruidosas." },
            { q: "¿Tú recibes dinero todas las semanas?", model: "Sí, mis padres me dan una pequeña paga semanal. Normalmente intento ahorrar la mayor parte para poder comprarme libros o videojuegos en el futuro." },
            { q: "¿Cuándo es tu cumpleaños?", model: "Mi cumpleaños es el doce de agosto. Suele hacer mucho calor, así que normalmente lo celebro en la piscina con mis amigos y una barbacoa familiar." },
            { q: "Para ti, ¿cómo sería un cumpleaños ideal?", model: "Mi cumpleaños ideal sería un viaje sorpresa a una gran ciudad como Nueva York o Madrid. Me encantaría visitar museos durante el día y ver un musical por la noche." },
            { q: "¿Cómo vas a celebrar el fin de tus exámenes?", model: "Para celebrar el fin de los exámenes, tengo la intención de organizar una cena especial con todos mis amigos en la playa para relajarnos y celebrar que por fin somos libres." },
            { q: "¿Qué te gustaría comprar con tu dinero?", model: "Si tuviera suficientes ahorros, me gustaría comprarme una cámara de fotos profesional. Me interesa mucho la fotografía artística y creo que sería una gran inversión." },

            // PAGINA 7 - OCIO Y TECNOLOGÍA
            { q: "¿Te gusta ver la tele? ¿Cuál es tu programa favorito?", model: "Sinceramente, prefiero las series de suspense en internet. Mi programa favorito es una serie criminal porque la trama es siempre muy intrigante y bien construida." },
            { q: "¿Prefieres la televisión o el cine? ¿Por qué?", model: "Sin duda prefiero el cine, ya que la pantalla grande y el sonido envolvente hacen que la experiencia sea mucho más emocionante que ver una película en casa." },
            { q: "Describe una película que has visto recientemente.", model: "Recientemente vi una película histórica sobre la guerra. Me pareció muy conmovedora y educativa, puesto que los actores hicieron un trabajo extraordinario transmitiendo emociones." },
            { q: "¿Qué tipo de música prefieres?", model: "Tengo gustos variados, pero prefiero el pop-rock porque tiene mucha energía. Sin embargo, también escucho música clásica cuando necesito concentrarme para estudiar." },
            { q: "¿Prefieres escuchar música o leer una revista?", model: "Normalmente prefiero escuchar música porque puedo hacerlo mientras realizo otras actividades. No obstante, leer una revista es ideal para desconectar de las pantallas un rato." },
            { q: "¿Te gusta surfear por internet? ¿Qué te parecen los chats?", model: "Me encanta navegar por internet para buscar información. Respecto a los chats, creo que son muy útiles para estar en contacto con amigos, aunque a veces pueden distraer demasiado." },
            { q: "Cuando sales con tus amigos, ¿adónde vais?", model: "Suelo ir con mis amigos a cafeterías del centro o al parque para jugar al fútbol. Los viernes por la noche solemos ir a la bolera o al cine." },
            { q: "¿Qué vas a hacer el sábado que viene por la noche?", model: "El próximo sábado por la noche tengo planeado ir a un concierto de jazz al aire libre. Me han dicho que el grupo es excelente y tengo muchas ganas de escucharlos." },
            { q: "¿Crees que la televisión es importante?", model: "En mi opinión, la televisión sigue siendo importante para las noticias, pero creo que internet es ahora mucho más vital para el entretenimiento personalizado y la educación." },
            { q: "¿Te gusta comprar ropa? ¿Qué estilo prefieres?", model: "Me gusta mucho comprar ropa, sobre todo en las rebajas. Prefiero un estilo cómodo e informal, como vaqueros y sudaderas, porque me siento más libre." },

            // PAGINA 8 - VACACIONES Y VIAJES
            { q: "¿Dónde vas de vacaciones normalmente?", model: "Normalmente paso mis vacaciones en la costa con mi familia. Nos encanta nadar en el mar y disfrutar de la gastronomía local, especialmente los mariscos frescos." },
            { q: "¿Qué haces durante las vacaciones?", model: "Durante las vacaciones suelo dedicar mi tiempo a descansar y a leer libros que no puedo leer durante el año escolar. También me gusta explorar pueblos cercanos y sacar fotos." },
            { q: "¿Prefieres las vacaciones con tu familia o con tus amigos?", model: "Depende. Con mi familia las vacaciones son más relajantes y cómodas, pero con mis amigos son mucho más aventureras y activas. Disfruto de ambas por razones diferentes." },
            { q: "¿Dónde fuiste de vacaciones el año pasado?", model: "El año pasado fui a Italia con mis padres. Visitamos Roma y Florencia; fue una experiencia cultural increíble ver tantos monumentos históricos de cerca." },
            { q: "¿Qué hiciste?", model: "Caminamos muchísimo por las ciudades históricas, comimos mucha pasta y pizza deliciosa, y visitamos el Vaticano. También tuvimos tiempo de descansar en un pequeño hotel con vistas." },
            { q: "¿Adónde vas a ir de vacaciones este año?", model: "Este año tengo la intención de ir a Japón con mi hermano. Me fascina la tecnología y la cultura tradicional japonesa, así que será un viaje de ensueño." },
            { q: "¿Cómo vas a viajar?", model: "Viajaremos en avión hasta Tokio y una vez allí usaremos el tren de alta velocidad para movernos entre ciudades, ya que dicen que es muy eficiente y puntual." },
            { q: "Si tuvieras mucho dinero, ¿adónde irías de vacaciones?", model: "Si no tuviera límites de presupuesto, me gustaría hacer un crucero alrededor del mundo. Me encantaría conocer diferentes continentes y culturas sin tener que preocuparme por el transporte." },
            { q: "¿Cuál es tu medio de transporte preferido para viajar?", model: "Mi medio de transporte favorito es el tren porque me permite disfrutar del paisaje con tranquilidad y es mucho más ecológico que el avión o el coche." },
            { q: "¿Te gusta viajar al extranjero?", model: "Me apasiona viajar al extranjero porque abre la mente y te permite ver el mundo desde una perspectiva diferente. Además, es la mejor forma de practicar los idiomas que estudio." },
            { q: "¿Has visitado España?", model: "Sí, he estado en España un par de veces. Lo que más me gustó fue la alegría de la gente y las tapas, además de la impresionante arquitectura de ciudades como Barcelona." },
            { q: "Describe las mejores vacaciones que has pasado.", model: "Mis mejores vacaciones fueron en un campamento de verano en los Pirineos. Hicimos senderismo, escalada y dormimos bajo las estrellas. Fue agotador pero inolvidable." },
            { q: "¿Qué país te gustaría conocer en el futuro?", model: "En el futuro me gustaría conocer Argentina para ver los glaciares y aprender sobre su historia. Me parece un país con una naturaleza salvaje y una cultura fascinante." }
        ];

        let currentIdx = 0;
        let timer, timeLeft = 30;
        let mediaRecorder, chunks = [];
        let isRecording = false;
        let userStream = null;

        // Renderizado Inicial
        const prepList = document.getElementById('prep-list');
        const refGuide = document.getElementById('reference-guide');
        questions.forEach((q, i) => {
            prepList.innerHTML += `<div class="border-b border-slate-100 pb-4"><label class="block text-slate-700 font-semibold mb-2 text-sm">${i+1}. ${q.q}</label><textarea class="w-full bg-slate-50 border border-slate-200 rounded-lg p-3 text-xs focus:ring-2 focus:ring-indigo-500 outline-none transition" placeholder="Notas clave..."></textarea></div>`;
            refGuide.innerHTML += `<div class="p-4 border border-slate-100 rounded-lg bg-slate-50"><p class="font-bold text-slate-800 text-sm mb-1">${i+1}. ${q.q}</p><p class="text-xs text-slate-600 bg-white p-3 rounded border border-slate-200 border-l-4 border-l-amber-400 italic leading-relaxed">${q.model}</p></div>`;
        });

        // Funciones Principales
        async function initApp() {
            try {
                userStream = await navigator.mediaDevices.getUserMedia({ audio: true });
                document.getElementById('initial-controls').classList.add('hidden');
                document.getElementById('active-controls').classList.remove('hidden');
                loadQuestion();
            } catch (err) { alert("Acceso al micrófono denegado. Es necesario para grabar respuestas."); }
        }

        function loadQuestion() {
            const q = questions[currentIdx];
            document.getElementById('current-question').innerText = q.q;
            document.getElementById('progress-text').innerText = `Pregunta ${currentIdx + 1} de ${questions.length}`;
            document.getElementById('review-area').classList.add('hidden');
            document.getElementById('active-controls').classList.remove('hidden');
            resetTimer();
        }

        function resetTimer() {
            clearInterval(timer); timeLeft = 30; updateTimerUI();
            timer = setInterval(() => { 
                timeLeft--; updateTimerUI(); 
                if (timeLeft <= 0) { clearInterval(timer); if(isRecording) toggleRecording(); }
            }, 1000);
        }

        function updateTimerUI() {
            const el = document.getElementById('timer-display');
            el.innerText = timeLeft + "s";
            el.classList.toggle('text-red-500', timeLeft <= 5);
        }

        async function toggleRecording() {
            const btn = document.getElementById('record-btn');
            const txt = document.getElementById('rec-text');
            if (!isRecording) {
                mediaRecorder = new MediaRecorder(userStream);
                chunks = [];
                mediaRecorder.ondataavailable = e => chunks.push(e.data);
                mediaRecorder.onstop = () => {
                    const blob = new Blob(chunks, { type: 'audio/webm' });
                    document.getElementById('audio-playback').src = URL.createObjectURL(blob);
                    document.getElementById('model-answer-content').innerHTML = `<strong>Modelo Sugerido:</strong><br>${questions[currentIdx].model}`;
                    document.getElementById('review-area').classList.remove('hidden');
                    document.getElementById('active-controls').classList.add('hidden');
                };
                mediaRecorder.start(); isRecording = true;
                btn.classList.add('recording-active'); txt.innerText = "Detener";
            } else {
                mediaRecorder.stop(); isRecording = false;
                btn.classList.remove('recording-active'); txt.innerText = "Grabar";
                clearInterval(timer);
            }
        }

        function nextQuestion() {
            if (currentIdx < questions.length - 1) { currentIdx++; loadQuestion(); } 
            else { showFinalReport(); }
        }

        function showFinalReport() {
            document.getElementById('sim-content').classList.add('hidden');
            document.getElementById('timer-display').classList.add('hidden');
            document.getElementById('progress-text').innerText = "Simulacro Finalizado";
            document.getElementById('final-report').classList.remove('hidden');
        }
    </script>
</body>
</html>






