<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador oral: Salud y Emergencias</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        @media print { .no-print { display: none; } }
        @keyframes pulse-red { 0%, 100% { background-color: #ef4444; } 50% { background-color: #b91c1c; } }
        .recording-active { animation: pulse-red 1.5s infinite; }
    </style>
</head>
<body class="bg-slate-50 min-h-screen pb-12">
<div style="position:fixed;top:20px;left:20px;z-index:9999" class="no-print"><a href="../index.html" style="display:inline-flex;align-items:center;gap:8px;padding:10px 16px;background:#6366f1;color:white;border-radius:8px;text-decoration:none;font-weight:600;box-shadow:0 2px 8px rgba(0,0,0,0.15);transition:all 0.2s" onmouseover="this.style.background='#4f46e5'" onmouseout="this.style.background='#6366f1'"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>Back to Resources</a></div>

    

    <div class="max-w-4xl mx-auto px-4 py-8">
        <!-- Header -->
        <header class="text-center mb-8 no-print">
            <h1 class="text-3xl font-bold text-slate-800">Práctica de Examen Oral: curso inicial</h1>
            <p class="text-slate-600 mt-2 font-medium">Bloque temático: La Salud y Situaciones de Emergencia</p>
            <div class="mt-4 flex justify-center gap-4">
                <button onclick="window.print()" class="bg-white border border-slate-300 px-4 py-2 rounded-lg text-sm font-semibold hover:bg-slate-50 transition shadow-sm">
                    🖨️ Imprimir Guía de Salud
                </button>
            </div>
        </header>

        <!-- Ficha de Preparación -->
        <section id="prep-section" class="bg-white rounded-xl shadow-sm border border-slate-200 p-8 mb-8">
            <h2 class="text-xl font-semibold text-slate-800 mb-6 flex items-center gap-2">
                <span class="bg-blue-100 text-blue-600 p-1.5 rounded-md">📝</span>
                1. Ficha de Notas Personales (Salud y Bienestar)
            </h2>
            <div id="prep-list" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Preguntas cargadas dinámicamente -->
            </div>
        </section>

        <!-- Modelos de Referencia -->
        <section id="ref-section" class="bg-white rounded-xl shadow-sm border border-slate-200 p-8 mb-8">
            <h2 class="text-xl font-semibold text-slate-800 mb-6 flex items-center gap-2">
                <span class="bg-amber-100 text-amber-600 p-1.5 rounded-md">💡</span>
                2. Modelos de Respuesta (Nivel 7)
            </h2>
            <div id="reference-guide" class="space-y-4"></div>
        </section>

        <!-- Simulador -->
        <section id="sim-section" class="no-print bg-slate-900 rounded-2xl p-8 text-white shadow-2xl relative overflow-hidden min-h-[450px] flex flex-col justify-between">
            <div class="relative z-10 w-full">
                <!-- Progress & Timer -->
                <div class="flex justify-between items-center mb-10">
                    <span id="progress-text" class="bg-slate-800 text-slate-400 px-3 py-1 rounded-full text-xs font-mono uppercase">Pregunta 1 de 11</span>
                    <div id="timer-display" class="text-4xl font-bold font-mono text-indigo-400">30s</div>
                </div>

                <!-- Main Content -->
                <div id="sim-content" class="text-center">
                    <div class="min-h-[140px] flex flex-col items-center justify-center">
                        <h3 id="current-question" class="text-2xl font-semibold leading-relaxed mb-6 px-4">¿Listo para practicar el bloque de Salud y Emergencias?</h3>
                        
                        <div id="initial-controls">
                            <button onclick="initApp()" class="bg-indigo-600 hover:bg-indigo-700 px-10 py-4 rounded-xl font-bold text-lg transition shadow-xl shadow-indigo-500/20">
                                Empezar Práctica Real
                            </button>
                        </div>

                        <div id="active-controls" class="hidden flex flex-col items-center gap-6 w-full">
                            <button id="record-btn" onclick="toggleRecording()" class="bg-red-600 hover:bg-red-700 px-10 py-4 rounded-xl font-bold transition flex items-center gap-3 shadow-lg shadow-red-500/20">
                                <span id="rec-dot" class="w-3 h-3 bg-white rounded-full"></span>
                                <span id="rec-text">Grabar Respuesta</span>
                            </button>
                        </div>
                    </div>

                    <!-- Individual Feedback Area -->
                    <div id="review-area" class="hidden mt-8 space-y-4 text-left w-full max-w-2xl mx-auto">
                        <div class="bg-slate-800 rounded-xl p-6 border border-slate-700">
                            <h4 class="text-xs font-bold text-slate-400 uppercase tracking-widest mb-4">Escucha tu respuesta</h4>
                            <audio id="audio-playback" controls class="w-full mb-6 filter invert opacity-80"></audio>

                            <!-- Mini Modelo en el simulador -->
                            <div class="bg-indigo-900/30 rounded-xl p-6 border border-indigo-500/30">
                                <div id="model-answer-content" class="text-sm text-indigo-100 leading-relaxed italic">
                                    <!-- Se carga dinámicamente -->
                                </div>
                            </div>
                        </div>
                        <button onclick="nextQuestion()" class="w-full bg-white text-slate-900 py-3 rounded-lg font-bold hover:bg-slate-100 transition shadow-lg">Siguiente Pregunta ?</button>
                    </div>
                </div>
            </div>

            <!-- Reporte Final UI -->
            <div id="final-report" class="hidden relative z-10 w-full max-w-2xl mx-auto text-left py-4">
                <div class="bg-white rounded-2xl p-8 text-slate-900 shadow-2xl border-t-8 border-indigo-600">
                    <h2 class="text-2xl font-bold mb-4 flex items-center gap-2 text-indigo-700">
                        ¡Sección Completada! 🎉
                    </h2>
                    <p class="text-slate-600 text-sm mb-6 pb-4 border-b">Has practicado las 11 preguntas clave sobre <strong>Salud y Emergencias</strong>.</p>
                    
                    <div class="bg-slate-50 p-6 rounded-xl mb-6 border border-slate-100 italic text-slate-700 text-sm">
                        "¡Buen trabajo! Has repasado temas vitales sobre hábitos saludables y experiencias personales. Recuerda que para el nivel 7 es fundamental hablar con naturalidad sobre el pasado y dar recomendaciones de salud sólidas."
                    </div>

                    <button onclick="location.reload()" class="w-full bg-indigo-600 text-white py-4 rounded-xl font-bold hover:bg-indigo-700 transition">Reiniciar Práctica</button>
                </div>
            </div>

            <!-- BG Pattern -->
            <div class="absolute -bottom-24 -right-24 w-80 h-80 bg-indigo-500/10 rounded-full blur-3xl"></div>
        </section>
    </div>

    <script>
        const questions = [
            { q: "¿Qué haces para mantenerte en forma?", model: "Para mantenerme en forma, trato de llevar un estilo de vida activo. Suelo ir al gimnasio tres veces por semana y, además, intento caminar al menos treinta minutos cada día para evitar el sedentarismo." },
            { q: "¿Qué opinas de la dieta mediterránea?", model: "En mi opinión, la dieta mediterránea es una de las más saludables del mundo. Se basa en el consumo de productos frescos como el aceite de oliva, frutas y legumbres, lo cual es fundamental para prevenir enfermedades." },
            { q: "¿Crees que los españoles comen bien?", model: "Sí, creo que en España se come bastante bien porque valoran mucho la calidad de los ingredientes y la cocina casera. Sin embargo, me parece que las nuevas generaciones están empezando a consumir más comida procesada." },
            { q: "¿Qué quiere decir 'comer sanamente'?", model: "'Comer sanamente' significa mantener una dieta equilibrada que proporcione todos los nutrientes necesarios. Implica evitar los alimentos ultraprocesados y priorizar las verduras, las proteínas y una hidratación constante." },
            { q: "¿Crees que es buena idea ser vegetariano?", model: "Considero que ser vegetariano es una opción excelente tanto por salud como por respeto al medio ambiente. No obstante, es vital planificar bien las comidas para asegurar que se obtienen todas las vitaminas necesarias, como la B12." },
            { q: "¿Alguna vez has tenido algún accidente?", model: "Afortunadamente, nunca he tenido un accidente grave. Solo recuerdo que cuando era niño me caí de la bicicleta y me hice una herida en la rodilla, lo cual fue una experiencia dolorosa pero aprendí a tener más precaución." },
            { q: "¿Has estado enferma alguna vez?", model: "Sí, hace un par de años tuve una gripe muy fuerte que me obligó a quedarme en cama durante una semana con mucha fiebre. Fue bastante pesado porque no podía asistir a clase ni ver a mis compañeros." },
            { q: "¿Qué piensas del fumar / de las drogas?", model: "Pienso que fumar y consumir drogas son hábitos extremadamente peligrosos y perjudiciales. No solo dañan los pulmones y el sistema nervioso, sino que también pueden crear una dependencia física y mental muy difícil de superar." },
            { q: "¿Eres deportista? ¿Crees que es importante hacer deporte?", model: "Me considero una persona deportista; juego al fútbol los fines de semana. Creo que hacer deporte es esencial no solo para la salud física, sino también para reducir el estrés académico y mejorar el bienestar mental en general." },
            { q: "¿Cuáles son los riesgos de tomar drogas?", model: "Los riesgos son inmensos: desde problemas cardíacos y cerebrales graves hasta el aislamiento social y la pérdida total de control sobre la propia vida. Es fundamental educar a los jóvenes sobre estas consecuencias devastadoras." },
            { q: "¿Qué haces para relajarte?", model: "Para relajarme, lo que más me gusta es meditar o escuchar música ambiental en mi habitación. A veces, también me ayuda mucho dar un paseo por el parque sin el teléfono móvil para desconectar totalmente de la tecnología." }
        ];

        let currentIdx = 0;
        let timer, timeLeft = 30;
        let mediaRecorder, chunks = [];
        let isRecording = false;
        let userStream = null;

        // 1. Initial Render
        const prepList = document.getElementById('prep-list');
        const refGuide = document.getElementById('reference-guide');
        questions.forEach((q, i) => {
            prepList.innerHTML += `<div class="border-b border-slate-100 pb-4"><label class="block text-slate-700 font-semibold mb-2 text-sm">${i+1}. ${q.q}</label><textarea class="w-full bg-slate-50 border border-slate-200 rounded-lg p-3 text-xs focus:ring-2 focus:ring-indigo-500 outline-none transition" placeholder="Anota vocabulario (ej. nutrición, dieta)..."></textarea></div>`;
            refGuide.innerHTML += `<div class="p-4 border border-slate-100 rounded-lg bg-slate-50"><p class="font-bold text-slate-800 text-sm mb-1">${i+1}. ${q.q}</p><p class="text-xs text-slate-600 bg-white p-3 rounded border border-slate-200 border-l-4 border-l-amber-400 italic leading-relaxed">${q.model}</p></div>`;
        });

        // 2. Core Functions
        async function initApp() {
            try {
                userStream = await navigator.mediaDevices.getUserMedia({ audio: true });
                document.getElementById('initial-controls').classList.add('hidden');
                document.getElementById('active-controls').classList.remove('hidden');
                loadQuestion();
            } catch (err) { alert("Acceso al micrófono denegado. Es necesario para grabar tus respuestas."); }
        }

        function loadQuestion() {
            const q = questions[currentIdx];
            document.getElementById('current-question').innerText = q.q;
            document.getElementById('progress-text').innerText = `Pregunta ${currentIdx + 1} de ${questions.length}`;
            document.getElementById('review-area').classList.add('hidden');
            document.getElementById('active-controls').classList.remove('hidden');
            resetTimer();
        }

        function resetTimer() {
            clearInterval(timer); timeLeft = 30; updateTimerUI();
            timer = setInterval(() => { 
                timeLeft--; updateTimerUI(); 
                if (timeLeft <= 0) { clearInterval(timer); if(isRecording) toggleRecording(); }
            }, 1000);
        }

        function updateTimerUI() {
            const el = document.getElementById('timer-display');
            el.innerText = timeLeft + "s";
            el.classList.toggle('text-red-500', timeLeft <= 5);
        }

        async function toggleRecording() {
            const btn = document.getElementById('record-btn');
            const txt = document.getElementById('rec-text');
            if (!isRecording) {
                mediaRecorder = new MediaRecorder(userStream);
                chunks = [];
                mediaRecorder.ondataavailable = e => chunks.push(e.data);
                mediaRecorder.onstop = () => {
                    const blob = new Blob(chunks, { type: 'audio/webm' });
                    document.getElementById('audio-playback').src = URL.createObjectURL(blob);
                    document.getElementById('model-answer-content').innerHTML = `<strong>Modelo Sugerido:</strong><br>${questions[currentIdx].model}`;
                    document.getElementById('review-area').classList.remove('hidden');
                    document.getElementById('active-controls').classList.add('hidden');
                };
                mediaRecorder.start(); isRecording = true;
                btn.classList.add('recording-active'); txt.innerText = "Detener Grabación";
            } else {
                mediaRecorder.stop(); isRecording = false;
                btn.classList.remove('recording-active'); txt.innerText = "Grabar Respuesta";
                clearInterval(timer);
            }
        }

        function nextQuestion() {
            if (currentIdx < questions.length - 1) { currentIdx++; loadQuestion(); } 
            else { showFinalReport(); }
        }

        function showFinalReport() {
            document.getElementById('sim-content').classList.add('hidden');
            document.getElementById('timer-display').classList.add('hidden');
            document.getElementById('progress-text').innerText = "Simulacro Finalizado";
            document.getElementById('final-report').classList.remove('hidden');
        }
    </script>
</body>
</html>







